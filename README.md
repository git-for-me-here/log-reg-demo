# Log-Reg-Demo

http://novickiy.comxa.com/demo

Модуль авторизации и регистрации пользователей, реализованный при помощи HTML, PHP, MySQL.
Для отправки данных на сервер используется AJAX с предварительной проверкой полей на jQuery.

## Структура файлов и директорий
* `index.php` - стартовый файл
* `classes` - классы с основным функционалом модуля
  * `Caretaker.class.php` - запрещает повторные регистрации с одного и того же ip адреса или отсрочивает их 
  на определенный промежуток времени
  * `Connect.class.php` - устанавливает соединение с БД
  * `DataBaseWorker.class.php` - содержит основные методы для работы с БД
  * `Helper.class.php` - содержит раличные второстепенные методы, необходимые для функционирования модуля
  * `Route.class.ph` - обеспечивает роутирование данных
  * `TemplatesWorker.class.php` - отвечает за работу шаблонов
* `config` - конфигурационные файлы
  * `config.php` - задает основные настройки модуля 
  * `init.php` - инициализирует скрипт
* `files` - директория для хранения различных файлов
  * `ip` - директория для хранения зарегистрированных ip-адресов
* `templates` - содержит файлы шаблонов и ресурсы, необходимые для их работы и отображения
  * `css` - стили CSS
    * `fonts` - шрифты
    * `style.css` - основной файл стилей
  * `img` - директория для хранения изображений
  * `js` - клиентские скрипты
    *  `ajax.js` - скрипт для валидации формы и отправки ее на сервер
  * `login.tpl.php` - форма авторизации
  * `main.tpl.php` - основная форма
  * `repassword.tpl.php` - форма запроса на восстановление пароля
  * `sign.tpl.phpp` - форма регистрации

## Структура таблицы users
```SQL
-- Таблица для хранения пользователей
CREATE TABLE IF NOT EXISTS `users` (
    `id` MEDIUMINT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    `username` VARCHAR(255) NOT NULL ,
    `mail` VARCHAR(255) NOT NULL UNIQUE,
    `phone` VARCHAR(20) NOT NULL,
    `password` VARCHAR(255) NOT NULL,
    `salt` VARCHAR(100) NOT NULL,
    `active` SMALLINT(1) NOT NULL DEFAULT '0'
) ENGINE=INNODB;
```
* `id` - уникальный идентификатор пользователя
* `username` - имя пользователя
* `mail` - e-mail пользователя
* `phone` - телефон пользователя
* `password` - шифрованный пароль
* `salt` - соль для шифрования пароля
* `active` - состояние аккаунта: 0 - не активирован, 1 - выслано письмо для подтверждения регистрации, 2 - активирован

## Важно!
Для корректной работы модуля:
* установите собственные значения для соединения с базой в файле `config.php`
* укажите ключи для капчи в файле `config.php`
* укажите правильные настройки `.htaccess` в корне для корректной работы роутирования
